Percentage of images in each category:

archaeological_site: 5.20666 %
building: 5.68975 %
ceramics: 5.04563 %
clothing: 5.36769 %
costume_accessories: 5.0993 %
drawing: 5.42136 %
furniture: 5.47504 %
inscription: 2.30811 %
jewellery: 4.88459 %
map: 4.72356 %
painting: 6.22652 %
photograph: 5.74342 %
postcard: 5.52872 %
sculpture: 5.42136 %
specimen: 5.31401 %
tapestry: 1.77134 %
textile: 5.47504 %
toy: 5.68975 %
weaponry: 4.50886 %
woodwork: 5.0993 %
Weights: [19.20618556701031, 17.57547169811321, 19.819148936170212, 18.63, 19.610526315789475, 18.445544554455445, 18.264705882352942, 43.325581395348834, 20.47252747252747, 21.170454545454547, 16.060344827586206, 17.411214953271028, 18.0873786407767, 18.445544554455445, 18.818181818181817, 56.45454545454545, 18.264705882352942, 17.57547169811321, 22.178571428571427, 19.610526315789475]



split 0

size train: 1508
size val: 168
size test: 187
Using a single device 

Building model resnet34
Training for 1 epochs 

[1,    23] loss: 58.026 validation loss: 45.338 acc: 0.188 f1: 0.125 precision: 0.116 recall: 0.184
checkpoint saved at /home/jcejudo/rd-img-classification-pilot/results/sample/split_0/checkpoint.pth

training finished, it took 0.23914313316345215 minutes

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
acc_test: 0.21875
f1_test: 0.17123785020011437
precision_test: 0.18934633301481124
recall_test: 0.22817460317460317
sensitivity_test: 0.22817460317460317
specificity_test: 0.9585791913917567
loss_test: 41.307656354445186
confusion_matrix_test 

[[2 0 0 0 0 3 0 0 1 0 0 1 0 0 0 0 0 0 0 0]
 [1 0 0 0 0 3 0 0 0 1 0 1 0 0 0 0 0 0 0 0]
 [0 0 4 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0]
 [1 0 0 1 0 0 0 1 0 0 0 2 0 0 0 0 0 0 0 0]
 [1 0 1 0 0 0 1 1 0 0 0 2 0 0 1 0 0 0 0 0]
 [0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 1 3 0 1 0 0 1 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 2 0 0 0 1 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 1 0 0 5 0 0 3 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 2 1 0 0 0 0 0 1 0 0 0 0 0 0 0]
 [0 0 0 0 0 3 2 0 0 0 0 1 0 0 1 0 0 0 0 0]
 [0 0 0 0 0 3 4 0 0 0 0 2 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 3 0 0 0 0 0 3 0 1 0 0 0 0 0 0]
 [1 0 0 0 0 3 1 0 1 1 0 1 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 4 0 0 0 0 0 0 0 0 2 0 0 0 0 0]
 [1 0 0 0 0 2 1 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 2 1 2 0 0 2 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 4 0 0 2 1 0 2 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 4 0 0 1 0 0 1 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 3 1 0 0 0 0 2 0 0 0 0 0 0 0 0]]
split 1

size train: 1508
size val: 168
size test: 187
Using a single device 

Building model resnet34
Training for 1 epochs 

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:603: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig,ax = plt.subplots(1,2,figsize=(20,20))
[1,    23] loss: 57.962 validation loss: 45.030 acc: 0.164 f1: 0.127 precision: 0.129 recall: 0.195
checkpoint saved at /home/jcejudo/rd-img-classification-pilot/results/sample/split_1/checkpoint.pth

training finished, it took 0.21740748087565104 minutes

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
acc_test: 0.171875
f1_test: 0.11822049973835688
precision_test: 0.10822259136212624
recall_test: 0.21547619047619046
sensitivity_test: 0.21547619047619046
specificity_test: 0.9566530672497058
loss_test: 40.77539584725936
confusion_matrix_test 

[[4 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0]
 [3 0 0 0 0 1 3 0 0 0 0 0 0 1 0 0 1 0 0 0]
 [0 0 3 0 0 1 0 1 0 0 0 0 0 0 0 0 1 0 0 0]
 [1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 7 0 0 0]
 [3 0 0 0 0 1 0 1 1 0 0 0 0 0 0 0 0 0 0 0]
 [1 0 0 0 0 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [5 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0]
 [3 0 0 0 0 0 0 0 4 0 0 0 0 0 1 0 0 0 0 0]
 [1 0 0 0 0 2 0 2 0 0 0 0 0 0 0 0 0 0 0 0]
 [1 0 0 0 0 3 0 0 0 0 0 0 0 0 1 0 1 0 0 0]
 [4 0 0 0 0 2 0 1 0 0 0 0 0 0 0 0 1 0 0 0]
 [1 0 0 0 0 4 0 2 0 0 0 0 0 0 0 0 0 0 0 0]
 [5 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0]
 [3 0 0 0 0 0 0 0 2 0 0 0 0 0 1 0 0 0 1 0]
 [1 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 1 0 0 0]
 [2 0 0 0 0 0 0 1 0 0 0 0 0 0 2 0 1 0 0 0]
 [3 0 0 0 0 2 0 0 3 0 0 0 0 0 0 0 0 0 0 0]
 [1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 3 0]
 [1 0 1 0 0 2 0 0 1 0 0 0 0 0 0 0 0 0 2 0]]
split 2

size train: 1508
size val: 168
size test: 187
Using a single device 

Building model resnet34
Training for 1 epochs 

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
[1,    23] loss: 58.139 validation loss: 44.858 acc: 0.227 f1: 0.166 precision: 0.170 recall: 0.224
checkpoint saved at /home/jcejudo/rd-img-classification-pilot/results/sample/split_2/checkpoint.pth

training finished, it took 0.22311846415201822 minutes

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
acc_test: 0.1171875
f1_test: 0.09624861090378331
precision_test: 0.08632723112128146
recall_test: 0.15936507936507935
sensitivity_test: 0.15936507936507935
specificity_test: 0.9535714976303928
loss_test: 40.81288644719251
confusion_matrix_test 

[[2 0 0 0 2 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [3 1 0 0 0 2 0 0 0 0 0 0 0 0 0 0 1 0 0 0]
 [2 0 0 0 0 0 0 0 0 3 0 1 0 0 0 0 0 0 0 0]
 [1 0 0 0 1 0 1 0 1 0 0 0 0 0 0 0 0 0 1 0]
 [0 0 0 0 1 2 0 0 0 1 0 0 0 0 0 0 2 0 3 0]
 [2 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [1 0 0 0 0 3 0 0 0 3 0 0 0 0 0 0 1 0 0 0]
 [0 0 0 0 0 2 0 0 0 2 0 0 0 0 0 0 0 0 0 0]
 [2 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0]
 [1 0 0 0 2 1 0 0 0 2 0 0 0 0 0 0 0 0 0 0]
 [3 0 0 0 0 3 0 0 0 1 0 0 0 0 0 0 0 0 0 0]
 [5 1 0 0 0 1 0 0 0 1 0 0 0 0 0 0 1 0 0 0]
 [3 0 0 0 1 1 0 0 0 1 0 0 0 0 0 2 0 0 0 0]
 [4 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0]
 [6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0]
 [0 0 0 0 3 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 5 0 0 0 0 1 0 0 0 0 0 0 2 0 1 0]
 [1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 3 0]
 [2 0 0 0 0 1 1 0 0 1 0 0 0 0 0 0 3 0 0 0]]
split 3

size train: 1509
size val: 168
size test: 186
Using a single device 

Building model resnet34
Training for 1 epochs 

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
[1,    23] loss: 58.175 validation loss: 45.579 acc: 0.156 f1: 0.092 precision: 0.086 recall: 0.152
checkpoint saved at /home/jcejudo/rd-img-classification-pilot/results/sample/split_3/checkpoint.pth

training finished, it took 0.20565162499745687 minutes

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
acc_test: 0.1640625
f1_test: 0.12527736152736152
precision_test: 0.17615348399246705
recall_test: 0.1775
sensitivity_test: 0.1775
specificity_test: 0.9559770582125277
loss_test: 41.20359490507393
confusion_matrix_test 

[[0 0 0 0 0 0 3 0 4 0 0 1 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 3 0 3 0 2 0 0 0 0 0 0 0 0 1]
 [1 0 1 1 0 0 1 0 1 0 0 1 0 0 0 0 0 0 0 0]
 [0 0 0 6 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 2 0 0 1 0 2 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 1 0 0 2 0 3 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 3 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 2 0 0 0 0 3 0 0 1 0 0 0 0 0 0 0 0]
 [0 0 0 1 0 0 3 0 3 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 1 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 1 0 0 0 0 5 0 0 0 0 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 2 0 4 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 1 0 0 0 0 2 0 1 0 0 0 0 0 0 0 0 0]
 [0 0 0 4 0 0 2 0 2 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 0]
 [1 0 0 1 0 0 2 0 4 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 2 0 0 1 0 6 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 0]
 [0 0 0 0 0 0 0 0 6 0 0 1 0 0 0 0 0 0 0 0]]
split 4

size train: 1509
size val: 168
size test: 186
Using a single device 

Building model resnet34
Training for 1 epochs 

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
[1,    23] loss: 58.284 validation loss: 45.946 acc: 0.203 f1: 0.174 precision: 0.172 recall: 0.220
checkpoint saved at /home/jcejudo/rd-img-classification-pilot/results/sample/split_4/checkpoint.pth

training finished, it took 0.2159854809443156 minutes

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
acc_test: 0.234375
f1_test: 0.19400660742766004
precision_test: 0.21115612648221344
recall_test: 0.2567063492063492
sensitivity_test: 0.2567063492063492
specificity_test: 0.9593133032854798
loss_test: 40.766409925235216
confusion_matrix_test 

[[1 0 0 0 1 0 0 0 0 4 0 0 0 3 1 0 0 0 0 0]
 [1 0 0 0 0 0 0 0 0 0 1 0 0 6 0 0 0 0 0 0]
 [0 1 0 0 1 0 0 0 1 0 4 0 0 1 0 0 0 0 0 0]
 [0 0 0 1 1 0 0 1 0 0 0 0 0 3 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 2 0 0 0 2 1 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 4 0 0 0 0 1 0 0 0 0 0]
 [0 0 0 0 1 0 1 0 0 0 0 0 0 2 1 0 0 0 0 0]
 [0 0 0 0 0 0 0 3 0 0 0 0 0 0 0 0 0 0 0 0]
 [1 0 0 0 1 0 0 1 0 0 0 0 0 3 0 0 1 0 0 0]
 [0 0 0 0 0 0 0 0 0 5 0 1 0 1 0 0 0 0 0 0]
 [0 0 0 0 1 0 0 0 0 2 2 0 0 3 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 1 0 0 0 2 0 0 0 0 0 0]
 [1 0 0 0 1 0 0 0 0 1 2 0 0 2 0 1 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 1 0 8 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 1 0 0 0 0 5 0 0 1 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0]
 [1 0 0 0 0 0 0 0 0 1 1 1 0 2 1 0 0 0 0 0]
 [0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 3 0 0]
 [0 0 2 0 0 0 0 0 0 0 0 0 0 4 1 0 0 1 0 0]
 [0 0 0 0 0 0 1 0 0 2 1 0 0 3 0 0 0 0 0 0]]
split 5

size train: 1509
size val: 168
size test: 186
Using a single device 

Building model resnet34
Training for 1 epochs 

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
[1,    23] loss: 57.838 validation loss: 46.042 acc: 0.188 f1: 0.142 precision: 0.135 recall: 0.184
checkpoint saved at /home/jcejudo/rd-img-classification-pilot/results/sample/split_5/checkpoint.pth

training finished, it took 0.21534435749053954 minutes

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
acc_test: 0.2421875
f1_test: 0.17990168636395049
precision_test: 0.15911663216011043
recall_test: 0.239265873015873
sensitivity_test: 0.239265873015873
specificity_test: 0.9598539292425718
loss_test: 41.01282132056452
confusion_matrix_test 

[[0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 4 0 0]
 [0 5 0 0 0 0 0 0 0 0 0 0 2 1 0 0 0 1 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 6 0 0]
 [0 0 0 4 0 0 0 0 0 0 0 1 0 0 0 0 0 2 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 5 0 0]
 [0 1 0 0 1 3 0 0 0 0 0 0 0 0 1 0 0 2 0 0]
 [0 2 0 0 1 0 0 0 0 0 2 3 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 4 0 0 1 0 0 0 0 0 0 0 0 0]
 [0 0 0 1 0 0 0 0 0 1 1 1 0 0 0 0 0 3 0 0]
 [0 3 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 2 0 0]
 [0 1 0 0 0 2 0 0 0 0 2 2 1 0 0 0 0 2 0 0]
 [0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 1 1 0 0]
 [0 0 0 0 0 0 0 0 0 0 3 0 2 0 0 0 0 1 0 0]
 [0 2 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 3 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 0 1 0 0 0]
 [0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0]
 [0 1 0 2 0 1 0 0 0 0 0 0 0 0 1 0 0 2 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0]
 [0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 3 0 0]
 [0 0 0 0 0 2 0 0 0 0 0 1 0 0 0 0 1 2 0 0]]
split 6

size train: 1509
size val: 168
size test: 186
Using a single device 

Building model resnet34
Training for 1 epochs 

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
[1,    23] loss: 58.182 validation loss: 44.908 acc: 0.188 f1: 0.159 precision: 0.178 recall: 0.198
checkpoint saved at /home/jcejudo/rd-img-classification-pilot/results/sample/split_6/checkpoint.pth

training finished, it took 0.2142020066579183 minutes

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
acc_test: 0.171875
f1_test: 0.16689333240574383
precision_test: 0.18388781030290463
recall_test: 0.20803571428571427
sensitivity_test: 0.20803571428571427
specificity_test: 0.9564819277567566
loss_test: 40.62340914818548
confusion_matrix_test 

[[0 3 1 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 1 4 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1]
 [0 2 0 0 2 0 0 0 0 1 0 0 0 1 0 0 1 0 0 1]
 [0 1 1 0 2 0 0 0 0 0 0 0 0 3 0 0 0 0 0 0]
 [0 2 0 1 0 0 0 0 0 0 0 0 2 1 0 0 0 0 0 0]
 [0 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 1 2 0 3 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0]
 [0 7 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0]
 [0 2 0 0 3 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0]
 [0 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 1]
 [0 2 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0]
 [0 4 0 0 3 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0]
 [0 3 1 0 1 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0]
 [0 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 3 0 0 1 0 0 0 0 0 0 0 0 2 0 0 1 0 0 0]
 [0 1 1 0 2 0 0 0 0 0 0 0 0 2 1 0 0 0 0 1]
 [0 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 1]
 [0 2 0 0 2 0 1 0 0 0 0 0 0 0 0 0 0 0 1 1]]
split 7

size train: 1509
size val: 168
size test: 186
Using a single device 

Building model resnet34
Training for 1 epochs 

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:549: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:550: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_yticklabels([0.0,0.2,0.4,0.6,0.8,1.0],fontsize=fontsize)
Traceback (most recent call last):
  File "train.py", line 93, in <module>
    net, history = train(
  File "/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py", line 324, in train
    optimizer.step()
  File "/opt/miniconda3/envs/class_env/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 26, in decorate_context
    return func(*args, **kwargs)
  File "/opt/miniconda3/envs/class_env/lib/python3.8/site-packages/torch/optim/adam.py", line 108, in step
    F.adam(params_with_grad,
  File "/opt/miniconda3/envs/class_env/lib/python3.8/site-packages/torch/optim/functional.py", line 98, in adam
    param.addcdiv_(exp_avg, denom, value=-step_size)
KeyboardInterrupt
