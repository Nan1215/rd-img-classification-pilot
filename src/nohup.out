split 0

size train: 1508
size val: 168
size test: 187
Training for 5 epochs 

[1,    23] loss: 67.956 validation loss: 51.309 acc: 0.148 f1: 0.122 precision: 0.160 recall: 0.149
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2,    23] loss: 65.263 validation loss: 49.200 acc: 0.273 f1: 0.200 precision: 0.246 recall: 0.243
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[3,    23] loss: 63.187 validation loss: 47.964 acc: 0.344 f1: 0.295 precision: 0.401 recall: 0.334
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[4,    23] loss: 61.906 validation loss: 48.638 acc: 0.406 f1: 0.327 precision: 0.387 recall: 0.370
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[5,    23] loss: 60.664 validation loss: 46.373 acc: 0.477 f1: 0.418 precision: 0.523 recall: 0.452

training finished, it took 1.0460067431131999 minutes

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
loss_test: 43.69457616143048
accuracy_test: 0.4609375
f1_test: 0.38785457189868955
precision_test: 0.41311484409310495
recall_test: 0.4283730158730158
sensitivity_test: 0.4283730158730158
specificity_test: 0.9715235048305375
confusion_matrix_test: [[0 3 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 2]
 [0 3 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 1]
 [0 0 4 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1]
 [0 0 0 6 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1]
 [0 0 0 0 5 0 0 0 0 1 0 0 0 0 0 0 0 2 0 1]
 [0 0 0 0 0 5 0 0 0 1 0 0 0 0 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 2]
 [0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 3]
 [0 1 0 0 0 1 0 0 0 4 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 1 0 0 0 1 4 0 0 0 0 0 0 0 0 1]
 [0 2 0 0 0 1 0 0 1 0 2 0 0 0 0 0 0 1 0 0]
 [0 1 0 0 0 0 0 0 0 0 5 0 2 0 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0 0 1 3 0 0 0 0 0 0 3 0 2]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 2 0 1]
 [0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 4 0 1]
 [0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 6 0]
 [0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0 6]]
split 1

size train: 1508
size val: 168
size test: 187
Training for 5 epochs 

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:374: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig,ax = plt.subplots(1,2,figsize=(20,20))
Traceback (most recent call last):
  File "train.py", line 85, in <module>
    model, history = train(
  File "/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py", line 233, in train
    val_metrics_dict, _, _ = validate_test(model,valloader,device,loss_function,encoding_dict)
  File "/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py", line 307, in validate_test
    for i,(images, labels) in enumerate(testloader):
  File "/opt/miniconda3/envs/class_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 435, in __next__
    data = self._next_data()
  File "/opt/miniconda3/envs/class_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1068, in _next_data
    idx, data = self._get_data()
  File "/opt/miniconda3/envs/class_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1034, in _get_data
    success, data = self._try_get_data()
  File "/opt/miniconda3/envs/class_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 872, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/opt/miniconda3/envs/class_env/lib/python3.8/multiprocessing/queues.py", line 107, in get
    if not self._poll(timeout):
  File "/opt/miniconda3/envs/class_env/lib/python3.8/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/opt/miniconda3/envs/class_env/lib/python3.8/multiprocessing/connection.py", line 424, in _poll
    r = wait([self], timeout)
  File "/opt/miniconda3/envs/class_env/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/opt/miniconda3/envs/class_env/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
