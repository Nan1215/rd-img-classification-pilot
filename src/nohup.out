split 0

size train: 1508
size val: 168
size test: 187
Training for 5 epochs 

[1,    23] loss: 65.710 validation loss: 50.012 acc: 0.219 f1: 0.142 precision: 0.197 recall: 0.201
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2,    23] loss: 63.260 validation loss: 48.545 acc: 0.266 f1: 0.213 precision: 0.220 recall: 0.291
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[3,    23] loss: 61.175 validation loss: 47.718 acc: 0.336 f1: 0.267 precision: 0.261 recall: 0.345
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[4,    23] loss: 59.506 validation loss: 46.553 acc: 0.391 f1: 0.315 precision: 0.306 recall: 0.409
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[5,    23] loss: 58.274 validation loss: 45.857 acc: 0.445 f1: 0.381 precision: 0.362 recall: 0.465

training finished, it took 1.097640057404836 minutes

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
acc_test: 0.4375
f1_test: 0.3603880220656536
precision_test: 0.34278846153846154
recall_test: 0.4404166666666667
sensitivity_test: 0.4404166666666667
specificity_test: 0.9702677868013275
loss_test: 42.45904573654746
confusion_matrix_test 

[[0 0 0 0 0 1 0 0 0 0 0 3 1 0 0 0 0 1 0 2]
 [0 0 0 0 0 0 3 0 0 0 0 0 0 0 0 0 0 0 1 1]
 [0 0 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 1]
 [0 0 0 5 0 0 0 0 0 0 0 1 0 0 0 0 0 1 0 0]
 [0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 4 0 1]
 [0 0 0 0 0 7 0 0 0 1 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 5 0 0 0 0 0 0 0 0 0 0 0 0 2]
 [0 0 0 0 0 0 0 3 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 2 1 0 0 0 1 0 0 2]
 [0 0 0 0 0 0 2 0 0 1 0 2 2 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 0 0 0 0 0 3 2 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 4 3 0 0 0 0 2 0 1]
 [0 0 0 1 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0]
 [0 0 0 0 0 0 1 0 0 1 0 1 0 0 0 0 0 0 0 0]
 [0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 3]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 0 1]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 5 1]
 [0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 7]]
split 1

size train: 1508
size val: 168
size test: 187
Training for 5 epochs 

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py:371: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig,ax = plt.subplots(1,2,figsize=(20,20))
[1,    23] loss: 65.842 validation loss: 49.903 acc: 0.266 f1: 0.164 precision: 0.132 recall: 0.267
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2,    23] loss: 63.732 validation loss: 47.985 acc: 0.375 f1: 0.249 precision: 0.216 recall: 0.364
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[3,    23] loss: 61.360 validation loss: 46.651 acc: 0.344 f1: 0.229 precision: 0.221 recall: 0.358
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[4,    23] loss: 59.905 validation loss: 46.735 acc: 0.414 f1: 0.278 precision: 0.248 recall: 0.383
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[5,    23] loss: 58.899 validation loss: 45.684 acc: 0.453 f1: 0.350 precision: 0.350 recall: 0.444

training finished, it took 1.0216793934504191 minutes

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
acc_test: 0.4453125
f1_test: 0.3509632741985683
precision_test: 0.41252917975744074
recall_test: 0.45073412698412696
sensitivity_test: 0.45073412698412696
specificity_test: 0.970858890603538
loss_test: 40.664601698278744
confusion_matrix_test 

[[6 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1]
 [0 0 0 4 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 1 1 1 0 0 0 0 0 0 0 0 1 0 0 0 0 5]
 [0 0 0 0 0 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 1 0 0 0 1 4 0 0 0 0 0 0 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 0 3 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3]
 [3 1 0 0 0 1 1 0 0 0 0 0 2 0 0 0 0 0 0 0]
 [1 2 1 0 0 1 0 0 0 0 0 0 2 0 0 0 0 0 0 0]
 [1 1 0 3 0 1 2 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [1 0 0 1 0 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0]
 [0 7 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0]
 [0 0 1 3 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1]
 [1 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 2]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 5]
 [0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 4]]
split 2

size train: 1508
size val: 168
size test: 187
Training for 5 epochs 

/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[1,    23] loss: 65.993 validation loss: 52.796 acc: 0.188 f1: 0.110 precision: 0.126 recall: 0.171
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2,    23] loss: 64.468 validation loss: 49.004 acc: 0.289 f1: 0.186 precision: 0.209 recall: 0.259
/home/jcejudo/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Traceback (most recent call last):
  File "train.py", line 85, in <module>
    model, history = train(
  File "/home/jcejudo/rd-img-classification-pilot/src/torch_utils.py", line 220, in train
    train_loss += loss.item()*inputs.shape[0]
KeyboardInterrupt
